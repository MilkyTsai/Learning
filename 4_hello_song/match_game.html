<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Hello Song Match Game</title>
    <style>
        :root { --selected-color: #ffd32a; --correct-btn: #2ecc71; --line-color: #ef57ff; --bg-color: #fcf8f3; }
        * { box-sizing: border-box; }
        body { font-family: 'Arial Rounded MT Bold', 'Microsoft JhengHei', sans-serif; background-color: var(--bg-color); text-align: center; margin: 0; padding: 10px; }
        h1 { color: #e76f51; font-size: 26px; margin: 15px 0 5px 0; }
        .hint { color: #8d8d8d; font-size: 16px; margin-bottom: 20px; }

        .game-container {
            display: flex; justify-content: space-between; width: 98%; max-width: 850px;
            margin: auto; background: white; padding: 25px; border-radius: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08); position: relative; min-height: 520px;
        }

        .column { display: flex; flex-direction: column; gap: 15px; width: 42%; z-index: 2; }

        .item {
            width: 100%; padding: 12px; background-color: #3498db; color: white; border: none;
            border-radius: 18px; cursor: pointer; transition: all 0.2s;
            box-shadow: 0 5px #2980b9; display: flex; 
            justify-content: center; align-items: center; height: 75px; position: relative;
        }
        
        /* ç­”æ¡ˆæŒ‰éˆ•ï¼šæ©«å‘æ’åˆ— (Row) */
        .item-anwser { 
            background-color: #e67e22; 
            box-shadow: 0 5px #d35400; 
            flex-direction: row; /* å¼·åˆ¶æ©«å‘æ’éšŠ */
            justify-content: space-between; /* æ–‡å­—é å·¦ï¼ŒIcon é å³ */
            padding: 0 20px;
        }

        .label-text { font-size: 22px; font-weight: bold; pointer-events: none; }
        
        /* Icon æ¨£å¼å„ªåŒ– */
        .quantity-icon { 
            font-size: 32px; /* ç¨å¾®ç¸®å°ä¸€é»ä»¥åˆ©ä¸¦æ’ */
            opacity: 0; 
            transition: opacity 0.5s; 
            pointer-events: none; 
            margin-left: 10px;
        }

        .item.selected { background-color: var(--selected-color) !important; box-shadow: 0 5px #ffa801 !important; color: #2f3542; transform: scale(1.05); }
        .item.matched { background-color: var(--correct-btn) !important; box-shadow: none !important; cursor: default; }
        .item.matched .quantity-icon { opacity: 1; }
        .item.wrong-shake { animation: shake 0.5s; background-color: #ff4757 !important; }

        #svg-lines { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 1; overflow: visible; }
        .connection-line { stroke: var(--line-color); stroke-width: 8; stroke-linecap: round; opacity: 0.8; stroke-dasharray: 10, 5; }

        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-8px); } 75% { transform: translateX(8px); } }
        .btn-bottom { margin-top: 25px; padding: 15px 40px; font-size: 20px; border-radius: 50px; border: none; background: #2a9d8f; color: white; cursor: pointer; box-shadow: 0 5px #21867a; font-weight: bold; }
    </style>
</head>
<body>

    <h1>Let's Match the Words! ğŸ¾</h1>
    <p class="hint">Hello Song Vocabulary Fun</p>

    <div class="game-container" id="main-game">
        <svg id="svg-lines"></svg>
        <div class="column" id="word-col"></div>
        <div class="column" id="anwser-col"></div>
    </div>

    <button class="btn-bottom" onclick="location.reload()">Next Game ğŸ”„</button>

    <script>
        const fullPairsData = [
            { id: 10, word: "great", anwser: "å¾ˆæ£’", icon: "ğŸ‘" },
            { id: 11, word: "friends", anwser: "æœ‹å‹", icon: "ğŸ‘­" },
            { id: 12, word: "Hello", anwser: "å¦³å¥½", icon: "ğŸ‘‹" },
            { id: 13, word: "good", anwser: "å¥½çš„", icon: "ğŸ‘Œ" },
            { id: 14, word: "play", anwser: "ç©è€", icon: "âš½" },
            { id: 15, word: "go", anwser: "å»", icon: "ğŸƒ" },
            { id: 16, word: "school", anwser: "å­¸æ ¡", icon: "ğŸ’" },
            { id: 17, word: "name", anwser: "åå­—", icon: "ğŸ“›" },
            { id: 18, word: "meet", anwser: "é‡è¦‹", icon: "ğŸ¤" },
            { id: 19, word: "say", anwser: "èªª", icon: "ğŸ’¬" },
            { id: 20, word: "Every day", anwser: "æ¯ä¸€å¤©", icon: "ğŸ—“ï¸" }
        ];

        let selectedBtn = null;
        let matchedCount = 0;
        let audioCtx = null;

        function initAudio() {
            if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            if (audioCtx.state === 'suspended') audioCtx.resume();
        }

        function playBeep(type) {
            initAudio();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain); gain.connect(audioCtx.destination);
            if (type === 'success') {
               // ç¬¬ä¸€è²å® (è¼ƒä½)
                const osc1 = audioCtx.createOscillator();
                const gain1 = audioCtx.createGain();
                osc1.connect(gain1); gain1.connect(audioCtx.destination);
                osc1.type = 'sine';
                osc1.frequency.setValueAtTime(1200, audioCtx.currentTime); // æ›´é«˜çš„èµ·é»
                gain1.gain.setValueAtTime(0.1, audioCtx.currentTime);
                gain1.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.2); // è²éŸ³æ¼¸å¼±
                osc1.start(); osc1.stop(audioCtx.currentTime + 0.2);

                // ç¬¬äºŒè²å® (æ›´é«˜æ›´æ¸…è„†)
                const osc2 = audioCtx.createOscillator();
                const gain2 = audioCtx.createGain();
                osc2.connect(gain2); gain2.connect(audioCtx.destination);
                osc2.type = 'sine';
                osc2.frequency.setValueAtTime(1600, audioCtx.currentTime + 0.1); // 0.1ç§’å¾Œç™¼å‡ºæ›´é«˜çš„éŸ³
                gain2.gain.setValueAtTime(0.1, audioCtx.currentTime + 0.1);
                gain2.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
                osc2.start(audioCtx.currentTime + 0.1); osc2.stop(audioCtx.currentTime + 0.3);
            } else if (type === 'wrong') {
                osc.type = 'sawtooth'; osc.frequency.setValueAtTime(150, audioCtx.currentTime);
                gain.gain.setValueAtTime(0.05, audioCtx.currentTime);
                osc.start(); osc.stop(audioCtx.currentTime + 0.2);
            } else if (type === 'fanfare') {
                [523.25, 659.25, 783.99, 1046.50].forEach((freq, i) => {
                    const o = audioCtx.createOscillator(); const g = audioCtx.createGain();
                    o.connect(g); g.connect(audioCtx.destination);
                    o.frequency.setValueAtTime(freq, audioCtx.currentTime + i * 0.1);
                    g.gain.setValueAtTime(0.1, audioCtx.currentTime + i * 0.1);
                    o.start(audioCtx.currentTime + i * 0.1); o.stop(audioCtx.currentTime + i * 0.1 + 0.3);
                });
            }
        }

        function speak(text) {
            window.speechSynthesis.cancel();
            const msg = new SpeechSynthesisUtterance(text);
            msg.lang = 'en-US'; msg.rate = 0.85;
            window.speechSynthesis.speak(msg);
        }

        function init() {
            const wordCol = document.getElementById('word-col');
            const answerCol = document.getElementById('anwser-col');
            
            const selection = [...fullPairsData].sort(() => Math.random() - 0.5).slice(0, 5);
            const words = [...selection].sort(() => Math.random() - 0.5);
            const anwsers = [...selection].sort(() => Math.random() - 0.5);

            words.forEach(data => {
                const btn = document.createElement('button');
                btn.className = 'item';
                btn.innerHTML = `<span class="label-text">${data.word}</span>`;
                btn.dataset.id = data.id;
                btn.onclick = () => {
                    initAudio(); speak(data.word);
                    if (selectedBtn && selectedBtn.parentElement === wordCol) selectedBtn.classList.remove('selected');
                    btn.classList.add('selected');
                    selectedBtn = btn;
                };
                wordCol.appendChild(btn);
            });

            anwsers.forEach(data => {
                const btn = document.createElement('button');
                btn.className = 'item item-anwser';
                // é€™è£¡ä¿®æ”¹ HTML çµæ§‹ï¼Œè®“ Icon è·Ÿåœ¨æ–‡å­—å¾Œé¢
                btn.innerHTML = `<span class="label-text">${data.anwser}</span><span class="quantity-icon">${data.icon}</span>`;
                btn.dataset.id = data.id;
                btn.onclick = () => {
                    if (!selectedBtn || btn.classList.contains('matched')) return;
                    initAudio();
                    if (selectedBtn.dataset.id === btn.dataset.id) {
                        playBeep('success');
                        selectedBtn.classList.add('matched');
                        btn.classList.add('matched');
                        drawLine(selectedBtn, btn);
                        matchedCount++;
                        selectedBtn = null;
                        if (matchedCount === 5) {
                            setTimeout(() => {
                                playBeep('fanfare');
                                document.getElementById('main-game').style.backgroundColor = "#e8f8f5";
                            }, 500);
                            setTimeout(() => speak("Great job! You know the Hello Song words!"), 1200);
                        }
                    } else {
                        playBeep('wrong');
                        btn.classList.add('wrong-shake');
                        selectedBtn.classList.add('wrong-shake');
                        setTimeout(() => {
                            btn.classList.remove('wrong-shake');
                            selectedBtn.classList.remove('wrong-shake');
                            selectedBtn.classList.remove('selected');
                            selectedBtn = null;
                        }, 500);
                    }
                };
                answerCol.appendChild(btn);
            });
        }

        function drawLine(btn1, btn2) {
            const svg = document.getElementById('svg-lines');
            const container = document.getElementById('main-game');
            const rect1 = btn1.getBoundingClientRect();
            const rect2 = btn2.getBoundingClientRect();
            const containerRect = container.getBoundingClientRect();

            const x1 = rect1.right - containerRect.left;
            const y1 = rect1.top + (rect1.height / 2) - containerRect.top;
            const x2 = rect2.left - containerRect.left;
            const y2 = rect2.top + (rect2.height / 2) - containerRect.top;

            const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            line.setAttribute('x1', x1); line.setAttribute('y1', y1);
            line.setAttribute('x2', x2); line.setAttribute('y2', y2);
            line.setAttribute('class', 'connection-line');
            svg.appendChild(line);
        }

        init();
    </script>
</body>
</html>